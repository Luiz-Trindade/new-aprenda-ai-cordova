import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as te,V as A,a as q,b as Q,c as z}from"./VCard-Bqd4Y468.js";import{a as se,e as oe,g as re,b as ae,h as ne,V as R,i as M,m as le,c as ie,j as ce,f as ue,d as de,k as me}from"./index-BHqptaOx.js";import{V as E}from"./VProgressCircular-DrCduS7i.js";import{g as B,p as D,a as W,t as U,H as fe,I as pe,f as r,J as _,m as he,j as ye,K as F,e as X,L as ge,c as ve,M as be,F as O,N as we,n as w,x as u,o as n,q as f,z as d,A as c,G as p,s as G,E as xe}from"./index-BqceoyPB.js";import{c as _e,a as ke,d as Ve,g as Ce,e as Ie,f as Te,m as Se}from"./router-DfCCwhug.js";import{a as x}from"./VBtn-DzfeoyvU.js";import{V as Pe}from"./VChip-CZ81TzZZ.js";import{V as N,m as Ae,a as H,b as qe,c as Qe,d as ze,e as Re}from"./VInput-CYkeImmX.js";import{V as Fe}from"./VDialog-D_RPNDDo.js";import{V as Oe}from"./VContainer-BoOdDGmZ.js";import"./group-Cydv_bni.js";import"./index-CiZ-jfdT.js";const Ne=te("v-alert-title"),Be=["success","info","warning","error"],De=D({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:F,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>Be.includes(e)},...ye(),...de(),...ue(),...Se(),...ce(),...Te(),...ie(),...le(),...he(),...Ie({variant:"flat"})},"VAlert"),K=B()({name:"VAlert",props:De(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{emit:l,slots:t}=s;const o=W(e,"modelValue"),a=U(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),{themeClasses:i}=fe(e),{colorClasses:m,colorStyles:h,variantClasses:k}=_e(()=>({color:e.color??e.type,variant:e.variant})),{densityClasses:V}=se(e),{dimensionStyles:y}=oe(e),{elevationClasses:g}=ke(e),{locationStyles:v}=re(e),{positionClasses:C}=Ve(e),{roundedClasses:I}=ae(e),{textColorClasses:T,textColorStyles:S}=ne(()=>e.borderColor),{t:Y}=pe(),J=U(()=>({"aria-label":Y(e.closeLabel),onClick(P){o.value=!1,l("click:close",P)}}));return()=>{const P=!!(t.prepend||a.value),Z=!!(t.title||e.title),$=!!(t.close||e.closable);return o.value&&r(e.tag,{class:["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},i.value,m.value,V.value,g.value,C.value,I.value,k.value,e.class],style:[h.value,y.value,v.value,e.style],role:"alert"},{default:()=>{var L,j;return[Ce(!1,"v-alert"),e.border&&r("div",{key:"border",class:["v-alert__border",T.value],style:S.value},null),P&&r("div",{key:"prepend",class:"v-alert__prepend"},[t.prepend?r(M,{key:"prepend-defaults",disabled:!a.value,defaults:{VIcon:{density:e.density,icon:a.value,size:e.prominent?44:28}}},t.prepend):r(R,{key:"prepend-icon",density:e.density,icon:a.value,size:e.prominent?44:28},null)]),r("div",{class:"v-alert__content"},[Z&&r(Ne,{key:"title"},{default:()=>{var b;return[((b=t.title)==null?void 0:b.call(t))??e.title]}}),((L=t.text)==null?void 0:L.call(t))??e.text,(j=t.default)==null?void 0:j.call(t)]),t.append&&r("div",{key:"append",class:"v-alert__append"},[t.append()]),$&&r("div",{key:"close",class:"v-alert__close"},[t.close?r(M,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>{var b;return[(b=t.close)==null?void 0:b.call(t,{props:J.value})]}}):r(x,_({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},J.value),null)])]}})}}}),Je=D({...Ae({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Le=B()({name:"VRadio",props:Je(),setup(e,s){let{slots:l}=s;return X(()=>{const t=N.filterProps(e);return r(N,_(t,{class:["v-radio",e.class],style:e.style,type:"radio"}),l)}),{}}}),je=D({height:{type:[Number,String],default:"auto"},...ze(),...we(Re(),["multiple"]),trueIcon:{type:F,default:"$radioOn"},falseIcon:{type:F,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Me=B()({name:"VRadioGroup",inheritAttrs:!1,props:je(),emits:{"update:modelValue":e=>!0},setup(e,s){let{attrs:l,slots:t}=s;const o=ge(),a=ve(()=>e.id||`radio-group-${o}`),i=W(e,"modelValue");return X(()=>{const[m,h]=be(l),k=H.filterProps(e),V=N.filterProps(e),y=t.label?t.label({label:e.label,props:{for:a.value}}):e.label;return r(H,_({class:["v-radio-group",e.class],style:e.style},m,k,{modelValue:i.value,"onUpdate:modelValue":g=>i.value=g,id:a.value}),{...t,default:g=>{let{id:v,messagesId:C,isDisabled:I,isReadonly:T}=g;return r(O,null,[y&&r(qe,{id:v.value},{default:()=>[y]}),r(Qe,_(V,{id:v.value,"aria-describedby":C.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:I.value,readonly:T.value,"aria-labelledby":y?v.value:void 0,multiple:!1},h,{modelValue:i.value,"onUpdate:modelValue":S=>i.value=S}),t)])}})}),{}}}),Ee={name:"QuizComponent",data(){return{loading:!0,contentReady:!1,startQuizTime:new Date,quizStarted:!1,currentQuestionIndex:0,selectedAnswer:null,score:0,showFeedback:!1,answerIsCorrect:!1,showResults:!1,currentTopic:{id:"1",title:"",difficulty:"",category:""},topicContent:["Aguarde, texto sendo gerado..."],questions:[],userAnswers:[]}},computed:{topicIcon(){return{ai:"mdi-robot",programming:"mdi-code-braces",math:"mdi-calculator"}[this.currentTopic.category]||"mdi-book"},currentQuestion(){return this.questions[this.currentQuestionIndex]},isLastQuestion(){return this.currentQuestionIndex===this.questions.length-1},correctAnswerText(){const e=this.currentQuestion.options.find(s=>s.correct);return e?e.text:""},resultColor(){const e=this.score/this.questions.length*100;return e>=80?"success":e>=50?"warning":"error"},resultMessage(){const e=this.score/this.questions.length*100;return e>=80?"Excelente!":e>=50?"Bom trabalho!":"Continue praticando!"},resultDescription(){const e=this.score/this.questions.length*100;return e>=80?"Você demonstrou um ótimo entendimento do tema.":e>=50?"Você tem um bom conhecimento básico, mas pode melhorar.":"Recomendamos revisar o material e tentar novamente."}},methods:{async loadContent(){try{this.loading=!0,this.contentReady=!1,await Promise.all([this.fetchTopicText(),this.fetchTopicQuiz()]),this.contentReady=!0}catch(e){console.error("Erro ao carregar conteúdo:",e),this.topicContent=["Ocorreu um erro ao carregar o conteúdo. Por favor, tente novamente."]}finally{this.loading=!1}},async fetchTopicText(){const e=localStorage.getItem("topic"),s=localStorage.getItem("difficulty"),t=await(await fetch(`${this.endpoint}/generate_topic_text/${e}/${s}/`)).json();this.topicContent=this.formatTopicText(t)},async fetchTopicQuiz(){const e=localStorage.getItem("topic"),s=localStorage.getItem("difficulty"),t=await(await fetch(`${this.endpoint}/generate_topic_quiz/${e}/${s}/`)).json();this.questions=this.extractJsonFromFormattedString(t)},startQuiz(){this.quizStarted=!0},checkAnswer(){this.showFeedback=!0;const e=this.currentQuestion.options[this.selectedAnswer];this.answerIsCorrect=e&&e.correct,this.storeUserAnswer(),this.answerIsCorrect&&this.score++},storeUserAnswer(){var e;this.userAnswers.push({questionIndex:this.currentQuestionIndex,questionText:this.currentQuestion.text,selectedOptionIndex:this.selectedAnswer,selectedOptionText:(e=this.currentQuestion.options[this.selectedAnswer])==null?void 0:e.text,isCorrect:this.answerIsCorrect,correctAnswerText:this.correctAnswerText,timestamp:new Date}),console.log("Resposta armazenada:",this.userAnswers[this.userAnswers.length-1])},nextQuestion(){this.showFeedback=!1,this.selectedAnswer=null,this.isLastQuestion?this.showResults=!0:this.currentQuestionIndex++},resetQuiz(){this.quizStarted=!1,this.currentQuestionIndex=0,this.selectedAnswer=null,this.score=0,this.showFeedback=!1,this.showResults=!1},formatTopicText(e){return!e||typeof e.topic_text!="string"?[]:e.topic_text.replace(/^#+\s/gm,"").split(/\n{2,}/).map(t=>t.trim()).filter(t=>t)},setTopicTitle(){const e=localStorage.getItem("topic"),s=localStorage.getItem("difficulty");this.currentTopic.title=e,this.currentTopic.difficulty=s},extractJsonFromFormattedString(e){try{const l=e.topic_quiz.replace(/```json\n?/,"").replace(/\n?```$/,"");return JSON.parse(l)}catch(s){return console.error("Erro ao extrair JSON:",s),[]}},setTopicProperties(){const e=localStorage.getItem("topic_id"),s=parseInt(this.score),l=parseInt(this.questions.length),t=parseFloat((s/l*100).toFixed(2));this.updateTopicProgress(e,t),this.updateTopicQuestions(e,l);const o=this.getTimeDifferenceUnit(this.startQuizTime),a=`${o.value} ${o.unit}`;localStorage.setItem("quiz_total_time",a),localStorage.setItem(e,JSON.stringify(this.userAnswers)),console.log("Todas as respostas salvas:",this.userAnswers),this.$router.push("/topics")},updateTopicProgress(e,s){const l=localStorage.getItem("topics"),t=JSON.parse(l||"[]"),o=t.find(a=>a.id===e);o&&(o.progress=s,localStorage.setItem("topics",JSON.stringify(t)))},updateTopicQuestions(e,s){const l=localStorage.getItem("topics"),t=JSON.parse(l||"[]"),o=t.find(a=>a.id===e);o&&(o.questions=Number(o.questions)+Number(s),localStorage.setItem("topics",JSON.stringify(t)))},getTimeDifferenceUnit(e,s=new Date){const l=s-e,t=Math.floor(l/1e3),o=Math.floor(l/6e4),a=Math.floor(l/36e5),i=Math.floor(l/864e5),m=Math.floor(i/30.44),h=Math.floor(i/365.25);return h>=1?{value:h,unit:"ano(s)"}:m>=1?{value:m,unit:"mês(es)"}:i>=1?{value:i,unit:"dia(s)"}:a>=1?{value:a,unit:"hora(s)"}:o>=1?{value:o,unit:"minuto(s)"}:{value:t,unit:"segundo(s)"}}},mounted(){this.setTopicTitle(),this.loadContent()}},Ue={key:0,class:"topic-intro"},Ge={key:0,class:"d-flex align-center justify-center flex-column"},He={key:1},Ke={key:1,class:"quiz-container"},We={class:"d-flex justify-space-between align-center mb-4"},Xe={class:"text-caption"},Ye={class:"text-center py-4"},Ze={class:"text-h5"},$e={class:"text-h6 mt-4",style:{"white-space":"pre-line","word-break":"break-word"}},et={class:"text-body-1 mt-2",style:{"white-space":"pre-line","word-break":"break-word"}};function tt(e,s,l,t,o,a){return u(),w(Oe,{class:"fade-in fill-height d-flex align-center justify-center"},{default:n(()=>[o.quizStarted?(u(),f("div",Ke,[r(A,{class:"pa-6",elevation:"2"},{default:n(()=>[p("div",We,[p("span",Xe,"Pergunta "+c(o.currentQuestionIndex+1)+" de "+c(o.questions.length),1),r(Pe,{color:"primary"},{default:n(()=>[d(" Pontuação: "+c(o.score)+"/"+c(o.questions.length),1)]),_:1})]),r(me,{"model-value":(o.currentQuestionIndex+1)/o.questions.length*100,color:"primary",height:"8",class:"mb-6"},null,8,["model-value"]),r(q,{class:"text-h6 mb-4",style:{"white-space":"pre-line","word-break":"break-word"}},{default:n(()=>[d(c(a.currentQuestion.text),1)]),_:1}),r(Q,null,{default:n(()=>[r(Me,{modelValue:o.selectedAnswer,"onUpdate:modelValue":s[0]||(s[0]=i=>o.selectedAnswer=i)},{default:n(()=>[(u(!0),f(O,null,G(a.currentQuestion.options,(i,m)=>(u(),w(Le,{key:m,label:i.text,value:m,color:"primary",class:"mb-2"},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o.showFeedback?(u(),w(K,{key:0,type:o.answerIsCorrect?"success":"error",variant:"tonal",class:"mb-4"},{default:n(()=>[d(c(o.answerIsCorrect?"Resposta correta!":`Resposta incorreta! A correta é: ${a.correctAnswerText}`),1)]),_:1},8,["type"])):xe("",!0),r(z,{class:"justify-end"},{default:n(()=>[o.showFeedback?(u(),w(x,{key:1,color:"primary",onClick:a.nextQuestion},{default:n(()=>[d(c(a.isLastQuestion?"Ver Resultado":"Próxima"),1)]),_:1},8,["onClick"])):(u(),w(x,{key:0,color:"primary",disabled:o.selectedAnswer===null,onClick:a.checkAnswer},{default:n(()=>s[6]||(s[6]=[d(" Verificar ")])),_:1,__:[6]},8,["disabled","onClick"]))]),_:1})]),_:1})])):(u(),f("div",Ue,[r(A,{class:"pa-6 mb-6",elevation:"2"},{default:n(()=>[r(q,{class:"text-h5 mb-4",style:{"white-space":"pre-line","word-break":"break-word"}},{default:n(()=>[r(R,{large:"",color:"primary",class:"mr-2"},{default:n(()=>[d(c(a.topicIcon),1)]),_:1}),d(" "+c(o.currentTopic.title),1)]),_:1}),r(Q,{class:"text-body-1"},{default:n(()=>[o.loading?(u(),f("div",Ge,[r(E,{class:"mb-2",size:70,width:7,color:"blue",indeterminate:""}),s[3]||(s[3]=p("h4",null,"Carregando conteúdo...",-1))])):(u(),f("div",He,[(u(!0),f(O,null,G(o.topicContent,(i,m)=>(u(),f("div",{key:"para-"+m,class:"mb-4"},c(i),1))),128)),r(K,{type:"info",variant:"tonal",class:"mt-6"},{default:n(()=>[d(" Este quiz contém "+c(o.questions.length)+" perguntas sobre o tema. Boa sorte! ",1)]),_:1})]))]),_:1}),r(z,null,{default:n(()=>[r(x,{variant:"flat",block:"",rounded:"xl",color:"primary",size:"large",class:"mt-4 elevation-2",onClick:a.startQuiz,disabled:o.loading||!o.contentReady},{default:n(()=>[r(R,{start:""},{default:n(()=>s[4]||(s[4]=[d("mdi-play")])),_:1,__:[4]}),s[5]||(s[5]=d(" Iniciar Quiz "))]),_:1,__:[5]},8,["onClick","disabled"])]),_:1})]),_:1})])),r(Fe,{modelValue:o.showResults,"onUpdate:modelValue":s[2]||(s[2]=i=>o.showResults=i),persistent:""},{default:n(()=>[r(A,null,{default:n(()=>[r(q,{class:"text-h5",style:{"word-break":"break-word"}},{default:n(()=>s[7]||(s[7]=[d(" Resultado do Quiz ")])),_:1,__:[7]}),r(Q,null,{default:n(()=>[p("div",Ye,[r(E,{size:120,width:15,"model-value":o.score/o.questions.length*100,color:a.resultColor,class:"mb-4"},{default:n(()=>[p("span",Ze,c(o.score)+"/"+c(o.questions.length),1)]),_:1},8,["model-value","color"]),p("p",$e,c(a.resultMessage),1),p("p",et,c(a.resultDescription),1)])]),_:1}),r(z,{class:"justify-center"},{default:n(()=>[r(x,{size:"small",variant:"flat",color:"success",onClick:s[1]||(s[1]=i=>a.setTopicProperties())},{default:n(()=>s[8]||(s[8]=[d(" Voltar aos tópicos ")])),_:1,__:[8]})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const ht=ee(Ee,[["render",tt],["__scopeId","data-v-a339ac4a"]]);export{ht as default};
